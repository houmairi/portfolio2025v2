---
import RepoCard from "./RepoCard.astro"
import CustomProjectCard from "./CustomProjectCard.astro"
import { getPinnedRepos, getGitHubProfileUrl } from '../utils/github.js';

const pinnedRepos = await getPinnedRepos();
const githubProfileUrl = getGitHubProfileUrl();

// Custom projects
const customProjects = [
  {
    name: "Lehrmittelstelle Uni Wien",
    description: "Webshop configurator for university dissertation printing services. Built as a 3-person team using Next.js and Tailwind CSS.",
    url: "https://lehrmittelstelle.at/",
    technology: "Next.js"
  },
  {
    name: "Painting Diary",
    description: "Art publication platform by Andr√© Hemer exploring painting through thoughtful writing and real-world gallery experiences.",
    url: "https://paintingdiary.com",
    technology: "CSS"
  }
];
---

<div id="projects-section" class="projects-section bg-neutral-800 py-4 sm:py-6 px-4 sm:px-6 rounded-xl mx-auto max-w-none overflow-hidden" style="opacity: 0;">
  <h2 id="projects-title" style="font-family: 'Satoshi', sans-serif; opacity: 0; transform: translateY(50px);" class="text-2xl sm:text-4xl md:text-6xl lg:text-8xl font-semibold text-white mb-4 sm:mb-6 leading-tight">Featured Projects</h2>
  <div id="projects-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 w-full">
    {customProjects.map((project) => (
      <div class="flex w-full min-w-0" style="opacity: 0; transform: translateY(30px);">
        <CustomProjectCard 
          name={project.name}
          description={project.description}
          url={project.url}
          technology={project.technology}
        />
      </div>
    ))}
    {pinnedRepos.map((repo) => (
      <div class="flex w-full min-w-0" style="opacity: 0; transform: translateY(30px);">
        <RepoCard 
          name={repo.name}
          description={repo.description}
          html_url={repo.html_url}
          language={repo.language}
        />
      </div>
    ))}
  </div>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';
  
  gsap.registerPlugin(ScrollTrigger);
  
  document.addEventListener('DOMContentLoaded', () => {
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: "#projects-section",
        start: "top 85%",
        toggleActions: "play none none none"
      }
    });
    
    tl.to("#projects-section", {
      duration: 0.8,
      opacity: 1,
      ease: "power2.out"
    })
    .to("#projects-title", {
      duration: 0.8,
      y: 0,
      opacity: 1,
      ease: "power2.out"
    }, "-=0.6")
    .to("#projects-grid > *", {
      duration: 0.6,
      y: 0,
      opacity: 1,
      stagger: 0.1,
      ease: "power2.out"
    }, "-=0.4")
    .to("#projects-footer", {
      duration: 0.6,
      opacity: 1,
      ease: "power2.out"
    }, "-=0.2");
  });
</script>
</div>