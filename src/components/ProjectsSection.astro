---
import RepoCard from "./RepoCard.astro"
import { getPinnedRepos, getGitHubProfileUrl } from '../utils/github.js';

const pinnedRepos = await getPinnedRepos();
const githubProfileUrl = getGitHubProfileUrl();
---

<div id="projects-section" class="projects-section bg-neutral-800 py-6 px-6 rounded-xl mx-auto" style="opacity: 0;">
  <h2 id="projects-title" style="font-family: 'Satoshi', sans-serif; opacity: 0; transform: translateY(50px);" class="text-4xl md:text-8xl font-semibold text-white mb-6">Featured Projects</h2>
  <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {pinnedRepos.map((repo) => (
      <div style="opacity: 0; transform: translateY(30px);">
        <RepoCard 
          name={repo.name}
          description={repo.description}
          html_url={repo.html_url}
          language={repo.language}
        />
      </div>
    ))}
  </div>
  
  <div id="projects-footer" class="mt-8 text-right" style="opacity: 0;">
    <a 
      href={githubProfileUrl}
      target="_blank" 
      rel="noopener noreferrer"
      class="inline-flex items-center gap-2 text-white hover:text-gray-300 font-medium transition-colors duration-200"
    >
      View more on my GitHub
      <svg class="w-4 h-4 transition-transform hover:translate-x-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
      </svg>
    </a>
  </div>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';
  
  gsap.registerPlugin(ScrollTrigger);
  
  document.addEventListener('DOMContentLoaded', () => {
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: "#projects-section",
        start: "top 85%",
        toggleActions: "play none none none"
      }
    });
    
    tl.to("#projects-section", {
      duration: 0.8,
      opacity: 1,
      ease: "power2.out"
    })
    .to("#projects-title", {
      duration: 0.8,
      y: 0,
      opacity: 1,
      ease: "power2.out"
    }, "-=0.6")
    .to("#projects-grid > *", {
      duration: 0.6,
      y: 0,
      opacity: 1,
      stagger: 0.1,
      ease: "power2.out"
    }, "-=0.4")
    .to("#projects-footer", {
      duration: 0.6,
      opacity: 1,
      ease: "power2.out"
    }, "-=0.2");
  });
</script>
</div>